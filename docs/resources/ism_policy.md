---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "opensearch_ism_policy Resource - terraform-provider-opensearch"
subcategory: ""
description: |-
  Opensearch ism policy. Not all the options supported by the api are supported by the provider at this time.
---

# opensearch_ism_policy (Resource)

Opensearch ism policy. Not all the options supported by the api are supported by the provider at this time.

## Example Usage

```terraform
resource "opensearch_ism_policy" "demo" {
  policy_id = "demo"
  description = "demo"
  default_state = "start"

  states {
    name = "start"

    transitions {
      state_name = "bloated"
      conditions {
        min_size = "5gb"
      }
    }

    transitions {
      state_name = "important"
      conditions {
        min_doc_count = 200
      }
    }

    transitions {
      state_name = "dead"
      conditions {
        min_index_age = "30d"
      }
    }
  }

  states {
    name = "important"

    actions {
      timeout = "5m"
      retry {
        count =   5
        backoff = "exponential"
        delay =   "1m"
      }

      action = "index_priority"
      index_priority = 500
    }

    actions {
      timeout = "5m"
      retry {
        count =   5
        backoff = "exponential"
        delay =   "1m"
      }

      action = "replica_count"
      replica_count = 4
    }

    transitions {
      state_name = "bloated"
      conditions {
        min_size = "5gb"
      }
    }

    transitions {
      state_name = "dead"
      conditions {
        min_index_age = "30d"
      }
    }
  }

  states {
    name = "bloated"

    actions {
      timeout = "5m"
      retry {
        count =   5
        backoff = "exponential"
        delay =   "1m"
      }

      action = "close"
    }

    transitions {
      state_name = "dead"
      conditions {
        min_index_age = "30d"
      }
    }
  }

  states {
    name = "dead"

    actions {
      timeout = "5m"
      retry {
        count =   5
        backoff = "exponential"
        delay =   "1m"
      }

      action = "delete"
    }
  }

  ism_template {
    index_patterns = ["qa*"]
    priority = 100
  }

  ism_template {
    index_patterns = ["staging*"]
    priority = 100
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **default_state** (String) Default states that indices will have.
- **description** (String) Description for the policy.
- **policy_id** (String) Unique identifier for the policy.
- **states** (Block Set, Min: 1) Permissions for index access the role has. (see [below for nested schema](#nestedblock--states))

### Optional

- **id** (String) The ID of this resource.
- **ism_template** (Block Set) Match of the indices to apply the policy on. (see [below for nested schema](#nestedblock--ism_template))

<a id="nestedblock--states"></a>
### Nested Schema for `states`

Required:

- **name** (String) Name of the state.

Optional:

- **actions** (Block List) Actions that should be run when an index reach the state. (see [below for nested schema](#nestedblock--states--actions))
- **transitions** (Block List) Transition specifications for when an index should transition to another state. (see [below for nested schema](#nestedblock--states--transitions))

<a id="nestedblock--states--actions"></a>
### Nested Schema for `states.actions`

Required:

- **action** (String) The action to execute. Currently supports: read_only, read_write, replica_count, open, close, delete, index_priority

Optional:

- **index_priority** (Number) Priority to set for the index if the action is index_priority
- **replica_count** (Number) Replicat count to set for the index if the action is replica_count
- **retry** (Block Set, Max: 1) Retry policy when the action fails (see [below for nested schema](#nestedblock--states--actions--retry))
- **timeout** (String) Time limit to perform the action

<a id="nestedblock--states--actions--retry"></a>
### Nested Schema for `states.actions.retry`

Required:

- **count** (Number) Number of retries

Optional:

- **backoff** (String) Backoff policy when retrying. Can be: Exponential, Constant and Linear
- **delay** (String) Base time to wait between retries



<a id="nestedblock--states--transitions"></a>
### Nested Schema for `states.transitions`

Required:

- **conditions** (Block Set, Min: 1, Max: 1) Conditions that trigger the state change. (see [below for nested schema](#nestedblock--states--transitions--conditions))
- **state_name** (String) Name of the state to transition to.

<a id="nestedblock--states--transitions--conditions"></a>
### Nested Schema for `states.transitions.conditions`

Optional:

- **min_doc_count** (Number) Minimum number of documents after which the index will transition.
- **min_index_age** (String) Minimum age at which the index will transition.
- **min_size** (String) Minimum size (not counting replication) after which the index will transition.




<a id="nestedblock--ism_template"></a>
### Nested Schema for `ism_template`

Required:

- **index_patterns** (Set of String) Indexes to include with wildcard support.

Optional:

- **priority** (Number)


